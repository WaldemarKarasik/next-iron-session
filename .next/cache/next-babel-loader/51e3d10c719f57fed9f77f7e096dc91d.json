{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\daniel\\\\Documents\\\\react\\\\next-iron-session\\\\pages\\\\login.jsx\",\n    _s = $RefreshSig$();\n\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState } from \"react\";\nimport useUser from \"../lib/useUser\";\nimport Layout from \"../components/Layout\";\nimport Form from \"../components/Form\";\nimport fetchJson from \"../lib/fetchJson\";\n\nvar Login = function Login() {\n  _s();\n\n  // here we just check if user is already logged in and redirect to profile\n  var _useUser = useUser({\n    redirectTo: \"/profile-sg\",\n    redirectIfFound: true\n  }),\n      mutateUser = _useUser.mutateUser;\n\n  var _useState = useState(\"\"),\n      errorMsg = _useState[0],\n      setErrorMsg = _useState[1];\n\n  function handleSubmit(_x) {\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  function _handleSubmit() {\n    _handleSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var body;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              body = {\n                username: e.currentTarget.username.value\n              };\n              _context.prev = 2;\n              _context.next = 5;\n              return mutateUser(fetchJson(\"/api/login\", {\n                method: \"POST\",\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(body)\n              }));\n\n            case 5:\n              _context.next = 11;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](2);\n              console.error(\"An unexpected error happened:\", _context.t0);\n              setErrorMsg(_context.t0.data.message);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 7]]);\n    }));\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  return __jsx(Layout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-324748941\" + \" \" + \"login\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }\n  }, __jsx(Form, {\n    isLogin: true,\n    errorMessage: errorMsg,\n    onSubmit: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 9\n    }\n  })), __jsx(_JSXStyle, {\n    id: \"324748941\",\n    __self: _this\n  }, \".login.jsx-324748941{max-width:21rem;margin:0 auto;padding:1rem;border:1px solid #ccc;border-radius:4px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZGFuaWVsXFxEb2N1bWVudHNcXHJlYWN0XFxuZXh0LWlyb24tc2Vzc2lvblxccGFnZXNcXGxvZ2luLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF5Q2tCLEFBRzJCLGdCQUNGLGNBQ0QsYUFDUyxzQkFDSixrQkFDcEIiLCJmaWxlIjoiQzpcXFVzZXJzXFxkYW5pZWxcXERvY3VtZW50c1xccmVhY3RcXG5leHQtaXJvbi1zZXNzaW9uXFxwYWdlc1xcbG9naW4uanN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCB1c2VVc2VyIGZyb20gXCIuLi9saWIvdXNlVXNlclwiO1xyXG5pbXBvcnQgTGF5b3V0IGZyb20gXCIuLi9jb21wb25lbnRzL0xheW91dFwiO1xyXG5pbXBvcnQgRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtXCI7XHJcbmltcG9ydCBmZXRjaEpzb24gZnJvbSBcIi4uL2xpYi9mZXRjaEpzb25cIjtcclxuXHJcbmNvbnN0IExvZ2luID0gKCkgPT4ge1xyXG4gIC8vIGhlcmUgd2UganVzdCBjaGVjayBpZiB1c2VyIGlzIGFscmVhZHkgbG9nZ2VkIGluIGFuZCByZWRpcmVjdCB0byBwcm9maWxlXHJcbiAgY29uc3QgeyBtdXRhdGVVc2VyIH0gPSB1c2VVc2VyKHtcclxuICAgIHJlZGlyZWN0VG86IFwiL3Byb2ZpbGUtc2dcIixcclxuICAgIHJlZGlyZWN0SWZGb3VuZDogdHJ1ZSxcclxuICB9KTtcclxuXHJcbiAgY29uc3QgW2Vycm9yTXNnLCBzZXRFcnJvck1zZ10gPSB1c2VTdGF0ZShcIlwiKTtcclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gaGFuZGxlU3VibWl0KGUpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgY29uc3QgYm9keSA9IHtcclxuICAgICAgdXNlcm5hbWU6IGUuY3VycmVudFRhcmdldC51c2VybmFtZS52YWx1ZSxcclxuICAgIH07XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgbXV0YXRlVXNlcihcclxuICAgICAgICBmZXRjaEpzb24oXCIvYXBpL2xvZ2luXCIsIHtcclxuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcclxuICAgICAgICB9KSxcclxuICAgICAgKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJBbiB1bmV4cGVjdGVkIGVycm9yIGhhcHBlbmVkOlwiLCBlcnJvcik7XHJcbiAgICAgIHNldEVycm9yTXNnKGVycm9yLmRhdGEubWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPExheW91dD5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJsb2dpblwiPlxyXG4gICAgICAgIDxGb3JtIGlzTG9naW4gZXJyb3JNZXNzYWdlPXtlcnJvck1zZ30gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdH0gLz5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxzdHlsZSBqc3g+e2BcclxuICAgICAgICAubG9naW4ge1xyXG4gICAgICAgICAgbWF4LXdpZHRoOiAyMXJlbTtcclxuICAgICAgICAgIG1hcmdpbjogMCBhdXRvO1xyXG4gICAgICAgICAgcGFkZGluZzogMXJlbTtcclxuICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XHJcbiAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAgICAgfVxyXG4gICAgICBgfTwvc3R5bGU+XHJcbiAgICA8L0xheW91dD5cclxuICApO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTG9naW47XHJcbiJdfQ== */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\daniel\\\\\\\\Documents\\\\\\\\react\\\\\\\\next-iron-session\\\\\\\\pages\\\\\\\\login.jsx */\"));\n};\n\n_s(Login, \"euIEtDHgOTGX0nY8ZaN9f/6/7u0=\", false, function () {\n  return [useUser];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["C:/Users/daniel/Documents/react/next-iron-session/pages/login.jsx"],"names":["React","useState","useUser","Layout","Form","fetchJson","Login","redirectTo","redirectIfFound","mutateUser","errorMsg","setErrorMsg","handleSubmit","e","event","preventDefault","body","username","currentTarget","value","method","headers","JSON","stringify","console","error","data","message"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,OAAOC,OAAP,MAAoB,gBAApB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAOC,IAAP,MAAiB,oBAAjB;AACA,OAAOC,SAAP,MAAsB,kBAAtB;;AAEA,IAAMC,KAAK,GAAG,SAARA,KAAQ,GAAM;AAAA;;AAClB;AADkB,iBAEKJ,OAAO,CAAC;AAC7BK,IAAAA,UAAU,EAAE,aADiB;AAE7BC,IAAAA,eAAe,EAAE;AAFY,GAAD,CAFZ;AAAA,MAEVC,UAFU,YAEVA,UAFU;;AAAA,kBAOcR,QAAQ,CAAC,EAAD,CAPtB;AAAA,MAOXS,QAPW;AAAA,MAODC,WAPC;;AAAA,WASHC,YATG;AAAA;AAAA;;AAAA;AAAA,6EASlB,iBAA4BC,CAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AACEC,cAAAA,KAAK,CAACC,cAAN;AAEMC,cAAAA,IAHR,GAGe;AACXC,gBAAAA,QAAQ,EAAEJ,CAAC,CAACK,aAAF,CAAgBD,QAAhB,CAAyBE;AADxB,eAHf;AAAA;AAAA;AAAA,qBAQUV,UAAU,CACdJ,SAAS,CAAC,YAAD,EAAe;AACtBe,gBAAAA,MAAM,EAAE,MADc;AAEtBC,gBAAAA,OAAO,EAAE;AAAE,kCAAgB;AAAlB,iBAFa;AAGtBL,gBAAAA,IAAI,EAAEM,IAAI,CAACC,SAAL,CAAeP,IAAf;AAHgB,eAAf,CADK,CARpB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAgBIQ,cAAAA,OAAO,CAACC,KAAR,CAAc,+BAAd;AACAd,cAAAA,WAAW,CAAC,YAAMe,IAAN,CAAWC,OAAZ,CAAX;;AAjBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KATkB;AAAA;AAAA;;AA8BlB,SACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA,uCAAe,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD;AAAM,IAAA,OAAO,MAAb;AAAc,IAAA,YAAY,EAAEjB,QAA5B;AAAsC,IAAA,QAAQ,EAAEE,YAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF;AAAA;AAAA;AAAA,onFADF;AAgBD,CA9CD;;GAAMN,K;UAEmBJ,O;;;KAFnBI,K;AAgDN,eAAeA,KAAf","sourcesContent":["import React, { useState } from \"react\";\r\nimport useUser from \"../lib/useUser\";\r\nimport Layout from \"../components/Layout\";\r\nimport Form from \"../components/Form\";\r\nimport fetchJson from \"../lib/fetchJson\";\r\n\r\nconst Login = () => {\r\n  // here we just check if user is already logged in and redirect to profile\r\n  const { mutateUser } = useUser({\r\n    redirectTo: \"/profile-sg\",\r\n    redirectIfFound: true,\r\n  });\r\n\r\n  const [errorMsg, setErrorMsg] = useState(\"\");\r\n\r\n  async function handleSubmit(e) {\r\n    event.preventDefault();\r\n\r\n    const body = {\r\n      username: e.currentTarget.username.value,\r\n    };\r\n\r\n    try {\r\n      await mutateUser(\r\n        fetchJson(\"/api/login\", {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(body),\r\n        }),\r\n      );\r\n    } catch (error) {\r\n      console.error(\"An unexpected error happened:\", error);\r\n      setErrorMsg(error.data.message);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div className=\"login\">\r\n        <Form isLogin errorMessage={errorMsg} onSubmit={handleSubmit} />\r\n      </div>\r\n      <style jsx>{`\r\n        .login {\r\n          max-width: 21rem;\r\n          margin: 0 auto;\r\n          padding: 1rem;\r\n          border: 1px solid #ccc;\r\n          border-radius: 4px;\r\n        }\r\n      `}</style>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}